<!-- User page -->
{% extends "base.html" %}
{% block content %}
<p><img class="display_pic" src="{{ person.pic }}"> {{ person.name }}</p>
<p>
	{{ person.name }} can trade ~{{ '%0.2f' % nearest_distance }} k.m. away.<br>
	<a href="/user/locations/{{ person.key.id() }}" target="_blank">view this user's trading locations</a>
</p>
<div class="game-comparison">
	<h3 id="tabs-examples">inventories and playlists comparison:</h3>
	<p>view the matches and differences between your inventories and playlists</p>
	<div class="bs-example bs-example-tabs">
		<ul id="myTab" class="nav nav-tabs" role="tablist">
			<li class="active"><a href="#yourinvnottheirpl" role="tab" data-toggle="tab">You own, they don't want</a></li>
			<li><a href="#yourinvtheirpl" role="tab" data-toggle="tab">You own, they want</a></li>
			<li><a href="#yourpltheirinv" role="tab" data-toggle="tab">You want, they own</a></li>
			<li><a href="#notyourpltheirinv" role="tab" data-toggle="tab">You don't want, they own</a></li>
		</ul>
	<div id="myTabContent" class="tab-content">
	<div class="tab-pane fade in active" id="yourinvnottheirpl">
		<div class="top-pad-one"><br>
			{% if my_diff %}
			<h4>games you own that are not in {{ person.name }}'s playlist</h4><br>
			<table class="sortable table table-bordered table-striped">
				<thead>
					<tr>
						<th width = "20%">title</th>
						<th width = "10%">platform</th>
						<th width = "50%">description</th>
						<th width = "20%">image</th>
					</tr>
				</thead>
				<tbody>
					{% for game in my_diff %}
					<tr>
						<td width = "20%">{{ game.title }}</td>
						<td width = "10%">{{ game.platform }}</td>
						<td width = "50%">{{ game.description }}</td>
						<td width = "20%"><img src="{{ game.pic }}"></td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
			{% else %}
			<div class="alert alert-info">
				you have no other games!
			</div>
			{% endif %}
		</div>
  	</div>
	<div class="tab-pane fade" id="yourinvtheirpl">
        <div class="top-pad-one"><br>
			{% if my_match %}
			<h4>games you own that are in {{ person.name }}'s playlist</h4><br>
			<table class="sortable table table-bordered table-striped">
				<thead>
					<tr>
						<th width = "20%">title</th>
						<th width = "10%">platform</th>
						<th width = "50%">description</th>
						<th width = "20%">image</th>
					</tr>
				</thead>
				<tbody>
					{% for game in my_match %}
					<tr>
						<td width = "20%">{{ game.title }}</td>
						<td width = "10%">{{ game.platform }}</td>
						<td width = "50%">{{ game.description }}</td>
						<td width = "20%"><img src="{{ game.pic }}"></td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
			{% else %}
			<div class="alert alert-info">
				you have no games {{ person.name }} wants!
			</div>
			{% endif %}
		</div>
	</div>
	<div class="tab-pane fade" id="yourpltheirinv">
		<div class="top-pad-one"><br>
			{% if your_match %}
			<h4>games {{ person.name }} owns that are in your playlist</h4><br>
			<table class="sortable table table-bordered table-striped">
				<thead>
					<tr>
						<th width = "20%">title</th>
						<th width = "10%">platform</th>
						<th width = "50%">description</th>
						<th width = "20%">image</th>
					</tr>
				</thead>
				<tbody>
					{% for game in your_match %}
					<tr>
						<td width = "20%">{{ game.title }}</td>
						<td width = "10%">{{ game.platform }}</td>
						<td width = "50%">{{ game.description }}</td>
						<td width = "20%"><img src="{{ game.pic }}"></td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
			{% else %}
			<div class="alert alert-info">
				{{ person.name }} has no games you want!
			</div>
			{% endif %}
		</div>
	</div>
	<div class="tab-pane fade" id="notyourpltheirinv">
		<div class="top-pad-one"><br>
			{% if your_diff %}
			<h4>games {{ person.name }} owns that are not in your playlist</h4><br>
			<table class="sortable table table-bordered table-striped">
				<thead>
					<tr>
						<th width = "20%">title</th>
						<th width = "10%">platform</th>
						<th width = "50%">description</th>
						<th width = "20%">image</th>
					</tr>
				</thead>
				<tbody>
					{% for game in your_diff %}
					<tr>
						<td width = "20%">{{ game.title }}</td>
						<td width = "10%">{{ game.platform }}</td>
						<td width = "50%">{{ game.description }}</td>
						<td width = "20%"><img src="{{ game.pic }}"></td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
			{% else %}
			<div class="alert alert-info">
				{{ person.name }} has no other games!
			</div>
			{% endif %}
		</div>
	</div>	
</div>
<div class="listings-header">
	<h3>listings</h3>
</div>
<div id="alerts">
	{% if not listings|length %}
	<div class="alert alert-info">
		no listings!
	</div>
	{% endif %}
</div>
{% if listings|length %}
{% for listing, own_games, seek_games in listings %}
<div id="{{ listing.key.urlsafe() }}" class="listing-block">
	<div class="row">
		<div class="col-md-12">
			<div class="listing-menu">
				<ul>
					<li><a class="btn btn-default" href="/listing/{{ listing.key.urlsafe() }}"><span class="glyphicon glyphicon glyphicon-link"></span></a></li>
					<li><div class="listing-date">posted {{ listing.date.strftime('%c') }}</div></li>
				</ul>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-md-6">
			<div class="panel panel-primary">
				<div class="panel-heading">
					<h1 class="panel-title">offering</h1>
				</div>
				{% if own_games|length %}
				<div class="table-responsive">
					<table class="sortable table table-bordered table-striped">
						<thead>
							<tr>
								<th width="80%" style="text-align: left">title</th>
								<th width="20%">platform</th>
							</tr>
						</thead>
						<tbody>
							{% for game in own_games %}
							<tr id="{{ game.key.urlsafe() }}">
								<td width="80%" style="text-align: left">{{ game.title }}</td>
								<td width="20%">{{ game.platform }}</td>
							</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
				{% else %}
				<div class="panel-body">
					<div class="alert alert-info">
						no games here!
					</div>
				</div>
				{% endif %}
				{% if listing.topup > 0 %}
				<div class="panel-footer listing-topup">
					<div class="input-group">
						<span class="input-group-addon">topup ${{ listing.topup }}</span>
					</div>
				</div>
				{% endif %}
			</div>
		</div>
		<div class="col-md-6">
			<div class="panel panel-primary">
				<div class="panel-heading">
					<h1 class="panel-title">requesting</h1>
				</div>
				{% if seek_games|length %}
				<div class="table-responsive">
					<table class="sortable table table-bordered table-striped">
						<thead>
							<tr>
								<th width="80%" style="text-align: left">title</th>
								<th width="20%">platform</th>
							</tr>
						</thead>
						<tbody>
							{% for game in seek_games %}
							<tr id="{{ game.key.urlsafe() }}">
								<td width="80%" style="text-align: left">{{ game.title }}</td>
								<td width="20%">{{ game.platform }}</td>
							</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
				{% else %}
				<div class="panel-body">
					<div class="alert alert-info">
						no games here!
					</div>
				</div>
				{% endif %}
				{% if listing.topup < 0 %}
				<div class="panel-footer listing-topup">
					<div class="input-group">
						<span class="input-group-addon">topup ${{ -listing.topup }}</span>
					</div>
				</div>
				{% endif %}
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-md-12">
			<h4>description</h4>
			<p>{{ listing.description or 'none' }}</p>
		</div>
	</div>
</div>
{% endfor %}
{% endif %}
{% endblock %}