{% extends "base.html" %}
{% block content %}
<div class="page-header">
	<h1>
		add to playlist
		<a class="btn btn-default" href="/playlist">back</a>
	</h1>
</div>
<div id="alerts"></div>
<form id="form" class="form-horizontal" role="form">
	<div class="form-group">
		<label for="title" class="col-sm-2 control-label">title</label>
		<div class="col-sm-10">
			<div class="input-group">
				<span class="input-group-addon">
					<span class="glyphicon glyphicon-book"></span>
				</span>
				<input id="title" type="text" class="form-control" placeholder="title">
			</div>
		</div>
	</div>
	<div class="form-group">
		<label for="platform" class="col-sm-2 control-label">platform</label>
		<div class="col-sm-10">
			<div class="input-group">
				<span class="input-group-addon">
					<span class="glyphicon glyphicon-tower"></span>
				</span>
				<select id="platform" class="form-control">
					<option>PC</option>
					<option>PS4</option>
					<option>Xbox One</option>
					<option>Wii U</option>
					<option>PS3</option>
					<option>Xbox 360</option>
					<option>Wii</option>
					<option>PS Vita</option>
					<option>3DS</option>
					<option>PSP</option>
					<option>DS</option>
					<option>Other</option>
				</select>
			</div>
		</div>
	</div>
	<div class="form-group">
		<label for="pic" class="col-sm-2 control-label">picture</label>
		<div class="col-sm-10">
			<div class="input-group">
				<span class="input-group-addon">
					<span class="glyphicon glyphicon-book"></span>
				</span>
				<input id="pic" type="text" class="form-control" placeholder="image url">
			</div>
		</div>
	</div>
	<div class="form-group">
		<label for="description" class="col-sm-2 control-label">description</label>
		<div class="col-sm-10">
			<div class="input-group">
				<span class="input-group-addon">
					<span class="glyphicon glyphicon-italic"></span>
				</span>
				<textarea id="description" class="form-control" rows="5" placeholder="special edition, DLC, condition, etc."></textarea>
			</div>
		</div>
	</div>
	<div class="form-group">
		<div class="col-sm-offset-2 col-sm-10">
			<button id="submit" type="button" class="btn btn-default">add</button>
		</div>
	</div>
</form>
<script>
	$("#submit").click( function(event) {
		clearAlerts();
		$('#form :input').prop('disabled', true);

		var title = $('#title').val().trim();
		var platform = $('#platform').val();
		var pic = $('#pic').val().trim();
		var description = $('#description').val().trim();

		if (!title) {
			$('#alerts').append(alertBootstrap('danger', 'title cannot be empty.'));
		} else {
			$.ajax({
				type: 'POST',
				url: '/playlist/add',
				data: {title: title, platform: platform, pic: pic, description: description},
				success: function(data, textStatus, jqXHR) {
					console.log(data);
					console.log(textStatus);
					console.log(jqXHR);
					
					$('#alerts').append(alertBootstrap('success', title + ' added to playlist'));
					alertTimeout(5000);

					$('#form')[0].reset()
				},
				error: function(jqXHR, textStatus, errorThrown) {
					console.log(jqXHR);
					console.log(textStatus);
					console.log(errorThrown);
					var errors = eval(jqXHR.responseText);

					for (var i = 0; i < errors.length; i++) {
						$('#alerts').append(alertBootstrap('danger', errors[i]));
					}
				}
			});
		}

		$('#form :input').prop('disabled', false);
	});
</script>
<script>
	$('#nav-pl').addClass("active");
</script>
{% endblock %}